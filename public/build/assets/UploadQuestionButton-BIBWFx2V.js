import{_ as p}from"./index-C-tSN4gj.js";import{_ as O}from"./FormErrorAlert.vue_vue_type_script_setup_true_lang-BD4eFiXL.js";import{d as S,s as m,T as $,i as j,o as a,g as i,b as l,n as N,a as o,u as t,w as v,e as d,t as y,F as B,p as V,c as x,h as c,K as q,L as P}from"./app-Dc-22UEF.js";import{c as k}from"./createLucideIcon-B2muY4Sh.js";import{X as R}from"./x-rTNT3fjF.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";/**
 * @license lucide-vue-next v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=k("CircleCheckBigIcon",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-vue-next v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=k("FileTextIcon",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-vue-next v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=k("RefreshCwIcon",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-vue-next v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=k("UploadIcon",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),Z={class:"flex flex-col gap-3"},G={class:"flex flex-col items-center justify-center gap-2"},J={key:0,class:"space-y-4"},Y={class:"space-y-2"},ee={class:"truncate flex-1"},te={class:"text-sm text-muted-foreground"},se={class:"flex items-center gap-2 flex-wrap"},re={key:0,class:"w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700"},le={key:1,class:"flex items-center text-sm text-green-600 dark:text-green-400"},L=5,ae=S({__name:"UploadQuestionButton",setup(oe){const u=m(null),D=m([]),g=m(0),f=m(!1),h=m(!1),s=$({files:[]}),F=j(()=>s.files.length>0),M=()=>{u.value&&!s.processing&&u.value.click()},_=(r=!0)=>{s.processing||(D.value=[],s.files=[],r&&(s.errors={}),g.value=0,f.value=!1,u.value&&(u.value.value=""))},U=r=>{var n;const e=r.target;(n=e.files)!=null&&n.length?I(Array.from(e.files)):_()},I=r=>{const e=r.filter(n=>[".xls",".xlsx",".csv"].some(w=>n.name.toLowerCase().endsWith(w))).slice(0,L);e.length&&(s.files=e,D.value=e.map(n=>n.name),b())},z=()=>{s.files.length&&b()},b=()=>{s.files.length&&(f.value=!1,s.post(route("questions.upload.multiple-smart"),{onProgress:r=>{const e=(r==null?void 0:r.percentage)||95;g.value=Math.round(e<100?e:99)},onSuccess:()=>{f.value=!0,_(!1),setTimeout(()=>{f.value=!1,window.location.reload()},5e3)},onError:()=>{}}))},A=r=>{r.preventDefault(),h.value=!0},E=r=>{r.preventDefault(),h.value=!1},T=r=>{r.preventDefault()},H=r=>{var e;r.preventDefault(),h.value=!1,(e=r.dataTransfer)!=null&&e.files.length&&I(Array.from(r.dataTransfer.files))};return(r,e)=>(a(),i(B,null,[l("div",Z,[l("div",{onDragenter:A,onDragleave:E,onDragover:T,onDrop:H,class:N(["border-2 border-dashed rounded-lg p-6 text-center transition-colors",h.value?"border-primary bg-primary/10":"border-muted-foreground/30",F.value?"hidden":"block"])},[l("div",G,[o(t(C),{class:"h-10 w-10 text-muted-foreground"}),e[1]||(e[1]=l("p",{class:"font-medium"},"Drag and drop your files here",-1)),e[2]||(e[2]=l("p",{class:"text-sm text-muted-foreground"},"or",-1)),o(t(p),{variant:"outline",onClick:M},{default:v(()=>e[0]||(e[0]=[d(" Browse Files ")])),_:1}),l("p",{class:"text-xs text-muted-foreground mt-2"}," Supported formats: .xls, .xlsx, .csv (Max "+y(L)+" files) ")])],34),F.value?(a(),i("div",J,[l("div",Y,[(a(!0),i(B,null,V(t(s).files,(n,w)=>(a(),i("div",{key:w,class:"flex items-center gap-3 p-2 border rounded"},[o(t(X),{class:"h-5 w-5 text-muted-foreground"}),l("span",ee,y(n.name),1),l("span",te,y((n.size/1024).toFixed(1))+" KB",1)]))),128))]),l("div",se,[o(t(p),{variant:"outline",onClick:M,disabled:t(s).processing,class:"h-auto"},{default:v(()=>[o(t(C),{class:"mr-2 h-4 w-4"}),e[3]||(e[3]=d(" Add More Files "))]),_:1},8,["disabled"]),t(s).processing?c("",!0):(a(),x(t(p),{key:0,variant:"outline",size:"sm",onClick:_,class:"text-destructive dark:text-red-300 hover:text-destructive"},{default:v(()=>[o(t(R),{class:"h-4 w-4 mr-1"}),e[4]||(e[4]=d(" Clear All "))]),_:1})),t(s).errors&&Object.keys(t(s).errors).length>0&&!t(s).processing?(a(),x(t(p),{key:1,variant:"outline",size:"sm",onClick:z,class:"text-amber-600 dark:text-amber-400"},{default:v(()=>[o(t(W),{class:"h-4 w-4 mr-1"}),e[5]||(e[5]=d(" Retry "))]),_:1})):c("",!0),o(t(p),{onClick:b,disabled:t(s).processing,class:"ml-auto"},{default:v(()=>[o(t(C),{class:"mr-2 h-4 w-4"}),d(" "+y(t(s).processing?`Uploading (${g.value}%)`:"Upload All"),1)]),_:1},8,["disabled"])]),t(s).processing?(a(),i("div",re,[l("div",{class:"bg-primary h-2.5 rounded-full transition-all duration-300",style:q({width:`${g.value}%`})},null,4)])):c("",!0),f.value?(a(),i("div",le,[o(t(Q),{class:"h-4 w-4 mr-1"}),e[6]||(e[6]=d(" Files uploaded successfully! "))])):c("",!0)])):c("",!0),l("input",{ref_key:"fileInput",ref:u,type:"file",accept:".xls,.xlsx,.csv",onChange:U,multiple:"",class:"hidden"},null,544)]),(a(),x(P,{defer:"",to:"#teleport-alert"},[Object.keys(t(s).errors).length>0?(a(),x(O,{key:0,"show-field-name":!1,errors:t(s).errors,"error-title":`Upload Error (${Object.keys(t(s).errors).length} ${Object.keys(t(s).errors).length===1?"Error":"Errors"})`},null,8,["errors","error-title"])):c("",!0)]))],64))}}),pe=K(ae,[["__scopeId","data-v-0a4c6d2e"]]);export{pe as U};
